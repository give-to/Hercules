src/main/java/org/apache/commons/lang3/text/ExtendedMessageFormat.java:157:replace:0,37$char fmtCount = 0;while (pos.getIndex() < pattern.length()) {switch (c[pos.getIndex()]) {case QUOTE:appendQuotedString(pattern, pos, stripCustom, true);break;case START_FE:fmtCount++;seekNonWs(pattern, pos);char start = pos.getIndex();char index = readArgumentIndex(pattern, next(pos));stripCustom.append(START_FE).append(index);seekNonWs(pattern, pos);Format format = null;String formatDescription = null;if (c[pos.getIndex()] == START_FMT) {formatDescription = parseFormatDescription(pattern,next(pos));format = getFormat(formatDescription);if (format == null) {stripCustom.append(START_FMT).append(formatDescription);}}foundFormats.add(format);foundDescriptions.add(format == null ? null : formatDescription);Validate.isTrue(foundFormats.size() == fmtCount);Validate.isTrue(foundDescriptions.size() == fmtCount);if (c[pos.getIndex()] != END_FE) {throw new IllegalArgumentException("Unreadable format element at position " + start);}default:stripCustom.append(c[pos.getIndex()]);next(pos);}}
